<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>X11workbench Toolkit: Menu Resources and Menu Callbacks</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">X11workbench Toolkit
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('menu_resource.html','');});
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Menu Resources and Menu Callbacks </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>For menus to be processed automatically by a <a class="el" href="group__frame__window.html#gacf113fd95153c5a0de0876becf0a83a5">Frame Window</a>, you need to set up menu resources and callback function arrays.</p>
<p>The menu identifiers are atoms that are specified using plain text identifiers, both in the menu resource AND in the menu callback arrays. These callback arrays are assigned to both <a class="el" href="group__frame__window.html#gacf113fd95153c5a0de0876becf0a83a5">Frame Windows</a> and <a class="el" href="group__child__frame.html#gaf06650d056e926657cc94548674c1d98">Child Frames</a>.</p>
<p>When a <a class="el" href="group__child__frame.html#gaf06650d056e926657cc94548674c1d98">Child Frame</a> has a menu assigned, or a menu callback array, whenever it is active its menu and/or callback array is used for automatic menu processing. Otherwise, the menu and/or callback array for the Frame Window will be used.</p>
<p>The <a class="el" href="group__frame__window.html#gacf113fd95153c5a0de0876becf0a83a5">Frame Window</a> allows you to automatically specify a menu resource and menu callback array when you create it, via the <a class="el" href="group__frame__window.html#gac6e419a4d4627321ddfaaf48711fc211" title="Create a frame window.">FWCreateFrameWindow()</a> function, and the <a class="el" href="group__frame__window.html#gab506e40699d1db64bbbef36dc62e4dde" title="Function to assign the default menu handler to a frame window.">FWSetMenuHandlers()</a> function. You first create the window, and then assign its menu handlers whenever you need them. You can also assign different handlers for different application states, as necessary.</p>
<p>A typical menu resource might look like the following example: </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> szAppMenu[]=<span class="stringliteral">&quot;1\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;_File\tpopup\t2\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;_Tools\tpopup\t5\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;\tseparator\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;_Help\tpopup\t3\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;2\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;_New File\tIDM_FILE_NEW\tNew File\tCtrl+N\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;_Open File\tIDM_FILE_OPEN\tOpen File\tCtrl+O\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;\tseparator\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;E_xit\tIDM_FILE_EXIT\tClose Application\tAlt+F4\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;3\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;_Contents\tIDM_HELP_CONTENTS\tHelp Contents\tAlt+F1\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;Conte_xt\tIDM_HELP_CONTEXT\tContext Help\tF1\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;\tseparator\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;_About X11workbench\tIDM_HELP_ABOUT\tAbout X11workbench\tAlt+F1\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;5\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;_Options\tIDM_TOOLS_OPTIONS\tDisplay Options Editor\n&quot;</span></div><div class="line">                        <span class="stringliteral">&quot;\n&quot;</span>;</div></div><!-- fragment --><p>This example shows top level menus for 'File', 'Tools', and 'Help' with a separator between 'Tools' and 'Help'. The '_' indicates that the next char will be displayed with an underscore, AND that it will act as a hotkey (top-level menus use Alt+char as the hotkey; popups can use other combinations).</p>
<p>To make the menu work, you need that callback array. For this menu, a simplified callback array is shown here (it uses macros for initialization):</p>
<div class="fragment"><div class="line"><a class="code" href="group__frame__menu.html#ga8a61ebc2ef84095119158df442cfca52">FW_MENU_HANDLER_BEGIN</a>(main_menu_handlers)</div><div class="line">  <a class="code" href="group__frame__menu.html#ga229372f84c3decfd19c503e93bcd0624">FW_MENU_HANDLER_ENTRY</a>(<span class="stringliteral">&quot;IDM_FILE_EXIT&quot;</span>,FileExitHandler,NULL)</div><div class="line">  <a class="code" href="group__frame__menu.html#ga229372f84c3decfd19c503e93bcd0624">FW_MENU_HANDLER_ENTRY</a>(<span class="stringliteral">&quot;IDM_FILE_NEW&quot;</span>,FileNewHandler,NULL)</div><div class="line">  <a class="code" href="group__frame__menu.html#ga229372f84c3decfd19c503e93bcd0624">FW_MENU_HANDLER_ENTRY</a>(<span class="stringliteral">&quot;IDM_FILE_OPEN&quot;</span>,FileOpenHandler,NULL)</div><div class="line">  <a class="code" href="group__frame__menu.html#ga229372f84c3decfd19c503e93bcd0624">FW_MENU_HANDLER_ENTRY</a>(<span class="stringliteral">&quot;IDM_HELP_ABOUT&quot;</span>,HelpAboutHandler,NULL)</div><div class="line">  <a class="code" href="group__frame__menu.html#ga229372f84c3decfd19c503e93bcd0624">FW_MENU_HANDLER_ENTRY</a>(<span class="stringliteral">&quot;IDM_HELP_CONTEXT&quot;</span>,HelpContextHandler,HelpContextUIHandler)</div><div class="line">  <a class="code" href="group__frame__menu.html#ga229372f84c3decfd19c503e93bcd0624">FW_MENU_HANDLER_ENTRY</a>(<span class="stringliteral">&quot;IDM_HELP_CONTENTS&quot;</span>,HelpContentsHandler,NULL)</div><div class="line"><a class="code" href="group__frame__menu.html#ga10289c47ba568d1a721f19b817d7a6b7">FW_MENU_HANDLER_END</a></div></div><!-- fragment --><p>The FW_MENU_HANDLER_BEGIN macro creates a variable 'main_menu_handlers' that is an array containing the menu handler information. Each entry following that has 3 parameters: </p><ul>
<li>The string identifier, in quotes, as defined in the menu resource </li>
<li>The menu callack that is invoked when the menu item is selected. Can be NULL if only a UI callback is needed. </li>
<li>The (optional) 'UI' menu callback that is invoked when the menu needs information on how to display itself. if there is no UI callback, then specify NULL.</li>
</ul>
<p>A menu UI callback returns a negative value to 'disable', or zero to 'enable' a menu item. Other capabilities are reserved for future use.</p>
<p>See Also: <a class="el" href="group__frame__menu.html#ga229372f84c3decfd19c503e93bcd0624">FW_MENU_HANDLER_ENTRY</a></p>
<p>The menu resources themselves consist of a set of lines, with several tab-delimited parameters on each line. The types of menu entries are: </p><ul>
<li>Menu Identifier: a number followed by a linefeed '\n'. This identifies a specific menu within the resource. The top level menu should be identfied with a "1\\n". </li>
<li>Menu Item: A string, followed by tabbed columns indicating the identifier, tooltip text, and shortcut key, and ending with a linefeed. Top level menu items will not have shortcut keys. </li>
<li>Popup Menu: A string, followed by tabbed columns, the first being the word 'popup', followed by a popup menu ID (a number), and a linefeed. </li>
<li>Separator: Begins with a tab character, and is followed by the word 'separator' and a linefeed. </li>
<li>Dynamic: (reserved) Begins with a tab character, followed by the word 'dynamic', a tab, and an identifier that will be passed to a UI callback. The UI callback will indicate which menu items will be inserted at that position. This functionality is reserved for future use.</li>
</ul>
<p>Popups are each identified by their own resource, which begins with a single number followed by a linefeed, followed by additional menu resource information. In the example, there are 4 popup menus identified by the numbers '2' through '5'. These can invoke other popup menus, as needed.</p>
<p>Menu callback functions have prototypes similar to the following: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> MenuHandler(XClientMessageEvent *pEvent);</div></div><!-- fragment --><p>It will be invoked by passing in a Client Message event, where the Atom for 'pEvent-&gt;message_type' will be <a class="el" href="group__menu.html#gab6bfa5084348ab4142dcbe45aa80fe27">'aMENU_COMMAND'</a>, and pEvent-&gt;data.l[0] will contain the menu item's Atom. This way, it is possible to share the same callback function for multiple message identifiers, by checking the contents of the XClientMessageEvent to determine how to process it.</p>
<p>A menu UI callback function is declared similar to the following: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> MenuUIHandler(<a class="code" href="struct____WBMenu.html">WBMenu</a> *pMenu, <a class="code" href="group__menu.html#ga6e4ffa6e5616302be7bbf961388d40f4">WBMenuItem</a> *pMenuItem);</div></div><!-- fragment --><p>The 'pMenu' and 'pMenuItem' pointers identify the menu and menu item associated with the UI request. The function will return '1' to enable, or -1 to disable the menu item associated with the callback. A value of '0' is currently undefined, and will result in a behavior as if NO UI callback were defined. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Dec 3 2019 11:20:30 for X11workbench Toolkit by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
